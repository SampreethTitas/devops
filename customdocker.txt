# main.py
import os

version = os.getenv("VERSION", "unknown")
print(f"Hello from Custom Dockerfile v{version}!")


print("Running inside Docker container")
print(f"Working Directory: {os.getcwd()}")
print(f"User: {os.getenv('USER', 'default')}")

nano requirements.txt
requests


# 1. FROM — base image
FROM ubuntu:22.04

# 2. LABEL — metadata
LABEL maintainer="sam.gmail.com"
LABEL subject="DevOps Lab"
LABEL version="1.0"

# 3. ENV — environment variables
ENV APP_HOME=/usr/src/app
ENV DEBIAN_FRONTEND=noninteractive

# 4. WORKDIR — working directory
WORKDIR $APP_HOME

# 5. RUN — update system
RUN apt-get update

# 6. RUN — install Python
RUN apt-get install -y python3 python3-pip

# 7. COPY — copy requirements.txt
COPY requirements.txt .

# 8. RUN — install Python dependencies
RUN pip install -r requirements.txt

# 9. COPY — copy local app file
COPY main.py .

# 10. RUN — create a new user
RUN useradd -ms /bin/bash devuser

# 11. USER — switch to non-root user
USER devuser

# 12. ARG — build-time variable
ARG APP_VERSION=1.0

# 13. ENV — pass ARG to runtime environment
ENV VERSION=$APP_VERSION

# 14. EXPOSE — open application port (for demo)
EXPOSE 5000

# 15. CMD — run app
CMD ["python3", "main.py"]


docker build -t python-lab-app .
docker run --rm python-lab-app
